provider = "google"
client_id = "${OAUTH_CLIENT_ID}"
client_secret = "${OAUTH_CLIENT_SECRET}"
# Redirect URL must match the authorized redirect URI in Google Cloud Console
# Format: https://oauth.${PUBLIC_FQDN}/oauth2/callback
redirect_url = "${OAUTH_REDIRECT_URL}"

# Email access control - using authenticated emails file for strict control
# Only emails listed in authenticated-emails.txt can access protected resources
authenticated_emails_file = "/config/authenticated-emails.txt"
# whitelist_domains configured via OAUTH2_PROXY_WHITELIST_DOMAINS environment variable
skip_auth_regex = []
# Skip the intermediate "Sign in with Google" button and redirect immediately to Google
skip_provider_button = true

cookie_name = "_oauth2_proxy"
cookie_path = "/"
cookie_expire = "168h"
cookie_refresh = "1h"
cookie_secure = true
cookie_httponly = true
cookie_samesite = "lax"
# Cookie domains will be set via environment variable OAUTH2_PROXY_COOKIE_DOMAINS
# CSRF cookie settings - disable cookie-based CSRF and use state parameter instead
# This avoids cross-site cookie blocking issues when browser returns from Google
cookie_csrf_per_request = false
cookie_csrf_expire = "15m"

# Store session in Redis
session_store_type = "redis"
# Using Redis ACL user 'oauth_user' with limited permissions for session storage
# Password is loaded from Docker secret file at runtime
# Format: redis://[username[:password]]@host:port/db
# Note: Password will be injected via environment variable OAUTH2_PROXY_REDIS_CONNECTION_URL
redis_connection_url = "redis://redis:6379/0"

http_address = "0.0.0.0:4180"
metrics_address = ":44180"

request_logging = true
auth_logging = true
standard_logging = true
ping_path = "/ping"
ready_path = "/ready"

proxy_prefix = "/oauth2"
scope = "openid email profile"

cookie_secret = "${OAUTH_COOKIE_SECRET}"
