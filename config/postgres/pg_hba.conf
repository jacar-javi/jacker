# PostgreSQL Client Authentication Configuration
# Documentation: https://www.postgresql.org/docs/current/auth-pg-hba-conf.html
#
# SECURITY MODEL:
# - Local socket connections: Require SCRAM-SHA-256 password authentication
# - Network connections: Use SCRAM-SHA-256 with SSL/TLS encryption (see postgresql.conf)
# - Docker networks: Restrict to known subnet ranges with secure authentication
# - Replication: Dedicated user with scram-sha-256 authentication
#
# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Local connections - SECURE: No passwordless access
local   all             all                                     scram-sha-256

# IPv4 local connections - localhost only
host    all             all             127.0.0.1/32            scram-sha-256

# IPv4 connections from Docker network - restricted to common Docker subnets
# Note: In production, restrict these further to specific container IPs/subnets
host    all             all             172.16.0.0/12           scram-sha-256

# IPv6 local connections
host    all             all             ::1/128                 scram-sha-256

# Replication connections - dedicated user with restricted access
host    replication     replicator      172.16.0.0/12           scram-sha-256
