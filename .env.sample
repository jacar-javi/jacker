# LOCAL USER AND PATHS
#========================================================================================================================
PUID=1000
PGID=1000
TZ=Europe/Madrid
USERDIR=/home/user
DOCKERDIR=/home/user/jacker
DATADIR=/home/user/jacker/data

# NETWORKING
#========================================================================================================================
HOSTNAME=mybox
DOMAINNAME=example.com
PUBLIC_FQDN=mybox.example.com
LOCAL_IPS=127.0.0.1/32,10.0.0.0/8,192.168.0.0/16,172.16.0.0/12
CODE_TRAEFIK_SUBNET_IP=192.168.71.253
DOCKER_DEFAULT_SUBNET=192.168.69.0/24
SOCKET_PROXY_SUBNET=192.168.70.0/24
SOCKET_PROXY_IP=192.168.70.254
TRAEFIK_PROXY_SUBNET=192.168.71.0/24
TRAEFIK_PROXY_IP=192.168.71.254
HOST_IS_VM=true

# UFW Firewall
#========================================================================================================================
# Comma separated UFW allow from rules used by assets/03-setup_ufw.sh
# If you make any changes re-run script
# By default we allow SSH from CODE_TRAEFIK_SUBNET_IP so we can ssh to host from terminal
UFW_ALLOW_FROM=
UFW_ALLOW_PORTS=
UFW_ALLOW_SSH=192.168.71.253

UFW_DOCKER_ALLOW_CONTAINERS=traefik 80,traefik 443

# AUTHENTICATION
#========================================================================================================================
# Authentication provider: google-oauth or authentik
# google-oauth: Simple Google OAuth2 integration (external provider)
# authentik: Self-hosted identity provider with advanced features (SSO, LDAP, SAML, etc.)
AUTH_PROVIDER=google-oauth

# GOOGLE OAUTH (when AUTH_PROVIDER=google-oauth)
#========================================================================================================================
# OAuth cookie default lifetime: 1 week
OAUTH_COOKIE_LIFETIME=604800
OAUTH_CLIENT_ID=
OAUTH_CLIENT_SECRET=
OAUTH_SECRET=
OAUTH_WHITELIST=

# AUTHENTIK (when AUTH_PROVIDER=authentik)
#========================================================================================================================
# Authentik version (check https://github.com/goauthentik/authentik/releases)
AUTHENTIK_VERSION=2024.10.4

# Authentik secret key - CHANGE THIS! Generate with: openssl rand -base64 60
AUTHENTIK_SECRET_KEY=

# Authentik PostgreSQL database
AUTHENTIK_POSTGRES_DB=authentik
AUTHENTIK_POSTGRES_USER=authentik
AUTHENTIK_POSTGRES_PASSWORD=

# Authentik log level: debug, info, warning, error
AUTHENTIK_LOG_LEVEL=info

# Authentik API token for Homepage widget (optional)
# Generate after setup from: https://auth.yourdomain.com/if/admin/#/core/tokens
AUTHENTIK_API_TOKEN=

# LETSENCRYPT
#========================================================================================================================
LETSENCRYPT_EMAIL=

# CROWDSEC
#========================================================================================================================
CROWDSEC_API_PORT=8888
CROWDSEC_TRAEFIK_BOUNCER_API_KEY=
CROWDSEC_IPTABLES_BOUNCER_API_KEY=
CROWDSEC_API_LOCAL_PASSWORD=

# PostgreSQL Database (used by CrowdSec)
POSTGRES_DB=crowdsec_db
POSTGRES_USER=crowdsec
POSTGRES_PASSWORD=password

# REDIS CACHE (OPTIONAL - For Performance Optimization)
#========================================================================================================================
# Redis in-memory cache for:
# - Rate limiting storage (distributed)
# - CrowdSec decision caching (faster IP checks)
# - Session storage for OAuth
# - Application-level caching

# Redis memory limit (default: 256mb)
# Adjust based on your server RAM: 2GB server = 256mb, 4GB+ server = 512mb-1gb
REDIS_MAXMEMORY=256mb

# Redis persistence (default: true)
REDIS_SAVE_ENABLED=true
REDIS_AOF_ENABLED=true

# ALERTING - Email Configuration
#========================================================================================================================
# SMTP server settings for email alerts
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_FROM=alerts@example.com
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
ALERT_EMAIL_TO=admin@example.com

# ALERTING - Telegram Configuration
#========================================================================================================================
# Telegram bot token and chat ID for critical alerts
# To create a bot: message @BotFather on Telegram and use /newbot
# To get chat ID: message @userinfobot on Telegram
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_CHAT_ID=123456789

# TRAEFIK - Security and Performance Configuration
#========================================================================================================================
# Traefik Tracing - Distributed tracing with Jaeger (OPTIONAL)
# Set to 'true' to enable tracing, 'false' to disable (default: false)
TRAEFIK_TRACING_ENABLED=false

# Jaeger endpoint for tracing (if TRAEFIK_TRACING_ENABLED=true)
# Default: jaeger:6831 for agent, http://jaeger:14268/api/traces for collector
JAEGER_AGENT_HOST=jaeger
JAEGER_AGENT_PORT=6831
JAEGER_COLLECTOR_ENDPOINT=http://jaeger:14268/api/traces

# Traefik Log Level - DEBUG, INFO, WARN, ERROR, FATAL, PANIC (default: INFO)
TRAEFIK_LOG_LEVEL=INFO

# Traefik Log Format - json or common (default: json)
TRAEFIK_LOG_FORMAT=json

# TLS Configuration
# TLS_MIN_VERSION - VersionTLS12 or VersionTLS13 (default: VersionTLS13)
# Set to VersionTLS12 only if you have clients that don't support TLS 1.3
TLS_MIN_VERSION=VersionTLS13

# Security Middlewares Configuration
# Request size limits in bytes (default: 10485760 = 10MB)
TRAEFIK_MAX_REQUEST_BODY_BYTES=10485760
TRAEFIK_MAX_RESPONSE_BODY_BYTES=10485760

# Rate Limiting Configuration
# Average requests per second (default: 100)
TRAEFIK_RATE_LIMIT_AVERAGE=100
# Burst size - requests allowed above average (default: 50)
TRAEFIK_RATE_LIMIT_BURST=50

# In-Flight Request Limiting
# Maximum concurrent requests (default: 100)
TRAEFIK_INFLIGHT_REQUEST_LIMIT=100

# IP Whitelist for Admin Services (comma-separated)
# Leave empty to allow access from LOCAL_IPS only
TRAEFIK_ADMIN_IP_WHITELIST=

# CrowdSec Plugin Mode
# Set to 'true' to use CrowdSec Traefik plugin instead of bouncer (experimental)
CROWDSEC_PLUGIN_MODE=false
